# 图像分割

## KMeans

无监督学习方法。

分类问题， 输入分类数目， 初始化中心位置

硬币分类方法， 以距离度量

迭代分类为聚类

- API
  - kmeans()

## 高斯混合模型

- 跟K-Means相比较，属于软分类

- 实现方法 -> 期望最大化（E-M）

  模型的EM训练过程，直观的来讲是这样：

  我们通过观察采样的概率值和模型概率值的接近程度，来判断一个模型是否拟合良好。然后我们通过调整模型以让新模型更适配采样的概率值。反复迭代这个过程很多次，直到两个概率值非常接近时，我们停止更新并完成模型训练。

  现在我们要将这个过程用算法来实现，所使用的方法是模型生成的数据来决定似然值，即通过模型来计算数据的期望值。通过更新参数μ和σ来让期望值最大化。这个过程可以不断迭代直到两次迭代中生成的参数变化非常小为止。该过程和k-means的算法训练过程很相似（k-means不断更新类中心来让结果最大化），只不过在这里的高斯模型中，我们需要同时更新**两个参数：分布的均值和标准差**

- 停止条件 -- 收敛

- 公式

![[公式]](https://www.zhihu.com/equation?tex=p%28x%29%3D%5Csum_%7Bi%3D1%7D%5E%7BK%7D%7B%5Cphi_%7Bi%7D%7D%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Csigma_%7Bi%7D%5E%7B2%7D%5Cpi%7D%7De%5E%7B-%5Cfrac%7B%28x-%5Cmu_%7Bi%7D%29%5E%7B2%7D%7D%7B2%5Csigma_%7Bi%7D%5E%7B2%7D%7D%7D)

​		首先分布概率是K个高斯分布的和，每个高斯分布有属于自己的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmu) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma) 参数，以及对应的权重参数，权重值必须为正数，所有权重的和必须等于1，以确保公式给出数值是合理的概率密度值。换句话说如果我们把该公式对应的输入空间合并起来，结果将等于1。

## 分水岭分割

- 基于图像形态学操作
  - 基于浸泡理论的分水岭分割方法
  - 基于连通图的方法
  - 基于距离变换的方法（Opencv） 

## Grabcut

- Grabcut介绍：交互抠图算法，Matting

- grabCut

- setMouseCallback

- onMouse

## 实战之证件照背景替换

知识点：

- K-Means
- 背景融合-- 高斯模糊
- 遮罩层的生成

步骤：

- 开始
- 数据组装
- KMeans分割
- 背景去除
- 遮罩生成
- 遮罩模糊
- 通道混和输出

## 绿幕背景视频抠图

知识点：

- 分割算法的选择
  - GMM？？KMeans？？ -- Very slow！！
  - 基于色彩的处理方法
  - RGB与HSV色彩空间
- 背景融合 - 高斯模糊
- 遮罩层的生成

步骤：

- 开始加载

- 帧图像 -> HSV

- 模型Mask

- 背景融合替换

- 显示

  、、、

--END
